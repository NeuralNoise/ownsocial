<div class="profile_index">

	<div class="row">
		<div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
			<?php if ($this->_currentUser->getId() === $this->user->getId()): ?>
			<div id="croppic-area" style="width: 100px; height: 100px;">
			<?php endif; ?>
				<img style="width: 100px; height: 100px;" src="/file/?file=<?= $this->user->getPortraitFileId(); ?>" />
			<?php if ($this->_currentUser->getId() === $this->user->getId()): ?>
			</div>
			<?php endif; ?>
		</div>
		<div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
			<h2><?= $this->escape($this->user->getFirstName() . ' ' . $this->user->getLastName()); ?></h2>
		</div>
	</div>

	<?php if ($this->_currentUser->getId() !== $this->user->getId()): ?>
		<?php

		$relation = $this->_currentUser->getRelationTo($this->user);

		if ($relation === null): ?>
		<a href="#" class="btn btn-primary add_request" data-id="<?= $this->user->getId(); ?>">
			<i class="fa fa-user"></i> Send contact request
		</a>
		<?php elseif (!$relation->getConfirmed() && $relation->getUserId2() === $this->user->getId()): ?>
		<a href="#" class="btn btn-primary" data-id="<?= $this->user->getId(); ?>">
			<i class="fa fa-clock-o"></i> Request pending...
		</a>
		<?php elseif (!$relation->getConfirmed() && $relation->getUserId2() === $this->_currentUser->getId()): ?>
		<p>Contact request:</p>
		<div class="btn-group">
			<button type="button" data-id="<?= $this->user->getId(); ?>" class="btn btn-primary accept_request">Accept</button>
			<button type="button" data-id="<?= $this->user->getId(); ?>" class="btn btn-default decline_request">Decline</button>
		</div>
		<?php endif; ?>
	<?php endif; ?>

</div>

<?php if ($this->_currentUser->getId() === $this->user->getId()): ?>
<script type="text/javascript">
	$(function() {
		var croppicContainerModalOptions = {
			uploadUrl: '/profile/save-pic/',
			cropUrl: '/profile/crop-pic/',
			modal: true,
			imgEyecandyOpacity:0.4,
			loaderHtml:'<div class="loader bubblingG"><span id="bubblingG_1"></span><span id="bubblingG_2"></span><span id="bubblingG_3"></span></div> '
		};

		var cropContainerModal = new Croppic('croppic-area', croppicContainerModalOptions);
	});
</script>
<?php endif; ?>